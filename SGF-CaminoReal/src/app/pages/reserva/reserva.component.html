<!-- HERO  -->
<app-hero />

<!-- Formulario de Reserva -->
<section class="py-16 bg-gray-50">
  <div class="max-w-6xl mx-auto px-4">
    <div class="bg-white rounded-xl shadow-lg p-8">

      <h2 class="text-2xl font-bold text-gray-900 mb-6">Buscar Disponibilidad</h2>

      <div class="grid grid-cols-1 md:grid-cols-4 gap-6">

        <!-- CHECK IN -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Check-in *</label>
          <input
            #checkInInput
            type="date"
            [min]="today"
            [ngModel]="checkIn()"
            (ngModelChange)="checkIn.set($event)"
            (click)="checkInInput.showPicker()"
            class="w-full px-4 py-3 border border-gray-300 rounded-lg cursor-pointer focus:border-transparent focus:outline-none focus:ring-2 focus:ring-purple-500 text-sm">
        </div>

        <!-- CHECK OUT -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Check-out *</label>
          <input
            #checkOutInput
            type="date"
            [min]="today"
            [ngModel]="checkOut()"
            (ngModelChange)="checkOut.set($event)"
            (click)="checkOutInput.showPicker()"
            class="w-full px-4 py-3 border border-gray-300 rounded-lg cursor-pointer focus:border-transparent focus:outline-none focus:ring-2 focus:ring-purple-500 text-sm">
        </div>

        <!-- HUÉSPEDES -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Huéspedes</label>
          <select [ngModel]="huespedes()" (ngModelChange)="huespedes.set(+($event))"
            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-transparent cursor-pointer focus:outline-none focus:ring-2 focus:ring-purple-500 text-sm pr-8">
            <option [ngValue]="1">1 Huésped</option>
            <option [ngValue]="2">2 Huéspedes</option>
            <option [ngValue]="3">3 Huéspedes</option>
            <option [ngValue]="4">4 Huéspedes</option>
            <option [ngValue]="6">+6 Huéspedes</option>
          </select>
        </div>

        <!-- BOTÓN -->
        <div class="flex items-end">
          <button
            type="button"
            (click)="onBuscar()"
            class="w-full bg-purple-700 hover:bg-purple-800 text-white px-6 py-3 rounded-lg font-semibold transition-colors cursor-pointer">
            <i class="ri-search-line mr-2"></i>
            Buscar
          </button>
        </div>

      </div>

      <div class="mt-6 p-4 bg-purple-50 rounded-lg">
        <p class="text-purple-800 font-medium">
          <i class="ri-information-line mr-2"></i>
          Tu estadía será de {{ noches() }} noches
        </p>
      </div>

    </div>
  </div>
</section>

<!-- Habitaciones Disponibles -->
@if (hasSearched()) {
  <section class="py-16">
    <div class="max-w-7xl mx-auto px-4">
      <h2 class="text-3xl font-bold text-gray-900 mb-8">Habitaciones Disponibles</h2>

      @if (!selectedRoom()) {
        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6">
          @for (habitacion of habitaciones(); track habitacion.nombre) {
            <app-card-habitacion
              [isSelected]="false"
              [isDisabled]="!habitacion.estado || isRoomReserved(habitacion)"
              [nombre]="habitacion.nombre"
              [imagen]="habitacion.imagen"
              [precio]="habitacion.precio"
              [capacidad]="habitacion.capacidad"
              [noches]="noches()"
              [caracteristicas]="habitacion.caracteristicas"
              (select)="seleccionarHabitacion(habitacion)"
            />
          }
        </div>
      }

      @if (selectedRoom()) {
        <div class="grid grid-cols-1 md:grid-cols-2 gap-10">
          <!-- CARD seleccionada (sola) -->
          <app-card-habitacion
            [isSelected]="true"
            [isDisabled]="false"
            [nombre]="selectedRoom()!.nombre"
            [imagen]="selectedRoom()!.imagen"
            [precio]="selectedRoom()!.precio"
            [capacidad]="selectedRoom()!.capacidad"
            [noches]="noches()"
            [caracteristicas]="selectedRoom()!.caracteristicas"
          />

          <!-- Resumen -->
          <div>
            <app-resumen
              [habitacion]="selectedRoom()!"
              [checkIn]="checkIn()"
              [checkOut]="checkOut()"
              [noches]="noches()"
              [huespedes]="huespedes()"
              (cancelar)="cancelarReserva()"
              (pagar)="irAPago($event)"
            />
          </div>

        </div>
      }
    </div>
  </section>
}
