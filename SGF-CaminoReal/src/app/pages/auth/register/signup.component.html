<app-auth-shell>
  <div class="w-full max-w-md bg-white/95 shadow-xl rounded-md px-8 py-6">
    <h2 class="text-2xl font-semibold text-gray-800 mb-1">Registrarse</h2>
    <p class="text-sm text-gray-500 mb-6">
      ¡Por favor, rellene este formulario para crear una cuenta!
    </p>

    @if (state.errores().general && !state.exito()) {
      <div
        class="mb-4 rounded-md border border-red-200 bg-red-50 px-3 py-2 text-xs text-red-700"
      >
        {{ state.errores().general }}
      </div>
    }

    <form class="space-y-4" (ngSubmit)="onSubmit($event)">
      <div class="flex gap-3">
        <div class="w-1/2">
          <input
            type="text"
            placeholder="Nombres"
            class="w-full h-10 px-3 border text-sm rounded-sm focus:outline-none focus:ring-1 focus:ring-sky-500"
            [class.border-red-400]="state.errores().nombres"
            [value]="state.form().nombres"
            (input)="onChange('nombres', $any($event.target).value)"
          />
          @if (state.errores().nombres) {
            <p class="mt-1 text-[11px] text-red-500">
              {{ state.errores().nombres }}
            </p>
          }
        </div>

        <div class="w-1/2">
          <input
            type="text"
            placeholder="Apellidos"
            class="w-full h-10 px-3 border text-sm rounded-sm focus:outline-none focus:ring-1 focus:ring-sky-500"
            [class.border-red-400]="state.errores().apellidos"
            [value]="state.form().apellidos"
            (input)="onChange('apellidos', $any($event.target).value)"
          />
          @if (state.errores().apellidos) {
            <p class="mt-1 text-[11px] text-red-500">
              {{ state.errores().apellidos }}
            </p>
          }
        </div>
      </div>

      <div>
        <input
          type="email"
          placeholder="Email"
          class="w-full h-10 px-3 border text-sm rounded-sm focus:outline-none focus:ring-1 focus:ring-sky-500"
          [class.border-red-400]="state.errores().email"
          [value]="state.form().email"
          (input)="onChange('email', $any($event.target).value)"
        />
        @if (state.errores().email) {
          <p class="mt-1 text-[11px] text-red-500">
            {{ state.errores().email }}
          </p>
        }
      </div>

      <div>
        <input
          type="text"
          placeholder="Usuario"
          class="w-full h-10 px-3 border text-sm rounded-sm focus:outline-none focus:ring-1 focus:ring-sky-500"
          [class.border-red-400]="state.errores().usuario"
          [value]="state.form().usuario"
          (input)="onChange('usuario', $any($event.target).value)"
        />
        @if (state.errores().usuario) {
          <p class="mt-1 text-[11px] text-red-500">
            {{ state.errores().usuario }}
          </p>
        }
      </div>

      <div>
        <input
          type="password"
          placeholder="Contraseña"
          class="w-full h-10 px-3 border text-sm rounded-sm focus:outline-none focus:ring-1 focus:ring-sky-500"
          [class.border-red-400]="state.errores().password"
          [value]="state.form().password"
          (input)="onChange('password', $any($event.target).value)"
        />
        @if (state.errores().password) {
          <p class="mt-1 text-[11px] text-red-500">
            {{ state.errores().password }}
          </p>
        }
      </div>

      <div>
        <input
          type="password"
          placeholder="Confirmar Contraseña"
          class="w-full h-10 px-3 border text-sm rounded-sm focus:outline-none focus:ring-1 focus:ring-sky-500"
          [class.border-red-400]="state.errores().confirmPassword"
          [value]="state.form().confirmPassword"
          (input)="onChange('confirmPassword', $any($event.target).value)"
        />
        @if (state.errores().confirmPassword) {
          <p class="mt-1 text-[11px] text-red-500">
            {{ state.errores().confirmPassword }}
          </p>
        }
      </div>

      <label class="flex items-center gap-2 text-xs text-gray-600">
        <input
          type="checkbox"
          class="h-3.5 w-3.5"
          [checked]="state.form().aceptaTerminos"
          (change)="onChange('aceptaTerminos', $any($event.target).checked)"
        />
        <span>
          Acepto los
          <a class="text-sky-600 underline" href="#">Términos de Uso</a>
          &
          <a class="text-sky-600 underline" href="#">Política de Privacidad</a>.
        </span>
      </label>
      @if (state.errores().aceptaTerminos) {
        <p class="mt-1 text-[11px] text-red-500">
          {{ state.errores().aceptaTerminos }}
        </p>
      }

      <button
        type="submit"
        class="mt-2 w-full h-10 cursor-pointer bg-sky-500 hover:bg-sky-600 text-white text-sm font-semibold rounded-sm disabled:opacity-60 disabled:cursor-not-allowed"
        [disabled]="state.cargando()"
      >
        @if (state.cargando()) { Registrando... } @else { Registrar }
      </button>

      @if (state.exito()) {
        <p class="mt-3 text-xs text-green-600 text-center">
          Registro exitoso. Redirigiendo al panel...
        </p>
      }

      <p class="mt-4 text-xs text-gray-600 text-center">
        ¿Ya tienes una cuenta?
        <a routerLink="/login" class="text-sky-600 font-semibold underline">
          Inicia sesión
        </a>
      </p>
    </form>
  </div>
</app-auth-shell>
